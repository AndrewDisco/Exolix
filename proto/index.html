<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>JavaScript Scrollbar</title>

        <style>
            body {
                font-family: sans-serif;
                font-size: 14px;
                line-height: 1.5;
                margin: 0;
                display: flex;
            }

            #container {
                width: 500px;
                height: 500px;
                overflow: auto;
                padding: 10px;
            }

            #scrollbar {
                width: 20px;
                height: 500px;
                background-color: #000;
                position: relative;
                display: flex;
                justify-content: center;
                padding: 10px 0;
            }

            #thumb {
                width: 5px;
                height: 50%;
                background-color: #fff;
                position: absolute;
                top: 10px;
                border-radius: 20px;
                transition: transform 100ms;
            }

            #scrollbar:hover > #thumb, #scrollbar:active > #thumb {
                cursor: pointer;
                transform: scaleX(1.5);
            }
        </style>
    </head>

    <body>
        <div id="container">
            <div id="content">
                <p>
                    Lorem ipsum dolor, sit amet consectetur adipisicing elit. Officiis ad velit sunt reiciendis facilis corporis ipsam dolore facere, obcaecati cum at voluptatem, sapiente amet deserunt necessitatibus totam in, dolor accusamus unde vitae dignissimos nisi ratione. Ullam aut perferendis id dolorem vel asperiores recusandae doloribus, illum odit voluptate sit numquam labore? Magnam quo nemo qui ducimus suscipit similique voluptas odit exercitationem sequi perspiciatis unde soluta vero, voluptatibus cumque explicabo magni, ipsa aliquam animi ipsum natus, accusamus sunt assumenda voluptatem. Inventore quisquam voluptatibus perspiciatis et velit asperiores repellat eveniet maiores. Porro deleniti ad reiciendis, qui pariatur asperiores eveniet praesentium, nesciunt neque cum eligendi accusantium cupiditate quia ex explicabo vitae accusamus rem doloribus ratione veritatis. Culpa optio, aliquam dolores adipisci numquam cumque exercitationem asperiores corporis, sit quo facilis quaerat dicta fugiat nobis obcaecati sequi est eaque ipsum esse quasi alias quae debitis. Quis reiciendis vero fugit eligendi repudiandae eius qui possimus architecto culpa magnam id minus, eaque pariatur inventore. Asperiores, quod dolorem id quos quibusdam dignissimos temporibus ex porro alias sunt incidunt saepe! Velit ad, et necessitatibus nam quod iusto vel voluptatem aspernatur aperiam officia delectus repudiandae quam error ipsum? Pariatur, quod iusto. Illo tempore ex cum magnam officia odit! Pariatur accusantium nobis ratione officiis quis, asperiores necessitatibus aspernatur hic sequi porro nulla? Neque ipsam tempore vitae fugit officiis officia ipsa nostrum autem eveniet dicta debitis accusantium, iure deleniti consequatur fuga quaerat reprehenderit? Laborum quasi dolor consequatur error, rerum at corrupti est nam, iste, natus reprehenderit maxime. Quidem, et laboriosam, fugit distinctio perspiciatis illo veritatis eaque exercitationem nesciunt sequi quia ullam beatae, soluta minus deleniti cupiditate excepturi possimus? Minima quam aut autem ea vel illo aperiam quos eaque error eius obcaecati vero voluptates, ad officia assumenda cupiditate nesciunt perspiciatis, qui illum libero, nostrum consequuntur corrupti atque? Laboriosam suscipit, reprehenderit veniam nulla illum repudiandae voluptates officiis quae omnis eos eligendi esse voluptatem quis delectus iure molestiae dolor autem nobis, modi voluptate incidunt tempora. Consectetur nostrum sequi repellendus fugit dolore facilis assumenda, dolorum iure similique iusto voluptatibus totam exercitationem numquam explicabo iste culpa, quidem ex quod tenetur doloribus? Illo dolores distinctio nihil sed perspiciatis, in voluptates beatae odit assumenda exercitationem dignissimos ipsa consectetur aperiam sint officia earum provident, eius doloribus. Ipsum excepturi nesciunt iste rerum quisquam repudiandae corrupti quas provident eaque et natus nulla quaerat eveniet cum quod pariatur temporibus ipsa animi, molestiae, tenetur assumenda magnam exercitationem similique officiis? Exercitationem illum perspiciatis harum fugiat veniam ducimus ex, ea debitis recusandae iusto, magni optio obcaecati enim a? Consectetur maxime ratione cumque sed molestias. Ipsam illo temporibus unde, quasi molestias minima eligendi ullam beatae eius odio sequi quae necessitatibus magni, illum sapiente, placeat maiores. Minus accusantium, earum obcaecati qui non expedita ad numquam possimus soluta enim, alias, veritatis id ullam consequatur. Sequi commodi, ratione totam a sapiente amet distinctio enim neque eligendi reiciendis. Voluptatem numquam eveniet laboriosam libero accusantium id ea officia fugiat? Est facere reiciendis, unde explicabo, nihil voluptas commodi architecto ex accusamus voluptatibus, nisi nemo! Aperiam, dolores fugit maxime tempora voluptatibus distinctio vero fuga veniam.
                </p>
            </div>
        </div>

        <div id="scrollbar">
            <div id="thumb"></div>
        </div>

        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

        <script>
            const scrollbar = $('#scrollbar');
            const thumb = $('#thumb');
            const content = $('#content');
            const container = $('#container');

            let isScrolling = false;

            function applyThumbHeight() {
                const containerHeight = container.height();
                const contentHeight = content.height();
                const thumbHeight = containerHeight / contentHeight * containerHeight;

                thumb.height(thumbHeight);
            }

            function applyThumbTop() {
                const contentHeight = content.height();
                const containerHeight = container.height();
                const scrollTop = container.scrollTop();

                const thumbHeight = thumb.height();
                const thumbTop = scrollTop / (contentHeight - containerHeight) * (containerHeight - thumbHeight);

                thumb.css('top', thumbTop);
            }

            function onThumbMouseDown(e) {
                isScrolling = true;

                const thumbTop = parseInt(thumb.css('top'));
                const containerHeight = container.height();
                const contentHeight = content.height();
                const scrollTop = container.scrollTop();

                const thumbHeight = thumb.height();
                const thumbBottom = thumbTop + thumbHeight;

                const mouseY = e.pageY;

                window.addEventListener('mousemove', onMouseMove);
                $(document).on('mouseup', onMouseUp);

                /**
                 * When moving the mouse, the thumb will be relative with mouse offsets.
                 */
                function onMouseMove(e) {
                    const mouseY = e.pageY;

                    const thumbTop = mouseY - (thumbHeight - mouseY);
                    const offset = thumbTop / (containerHeight - thumbHeight) * (contentHeight - containerHeight);

                    if (thumbTop < 0) {
                        thumb.css('top', 0);
                    } else if (thumbBottom > containerHeight) {
                        thumb.css('top', containerHeight - offset / 2);
                    } else {
                        thumb.css('top', offset - thumbTop);
                    }

                    const scrollTop = (thumbTop / (containerHeight - thumbHeight)) * (contentHeight - containerHeight);

                    container.scrollTop(scrollTop);
                }


                function onMouseUp() {
                    isScrolling = false;

                    $(document).off('mouseup', onMouseUp);
                    window.removeEventListener('mousemove', onMouseMove);
                }

                const mouseUpListener = () => {
                    onMouseUp();
                    window.addEventListener('mouseup', mouseUpListener);
                }

                window.addEventListener('mouseup', mouseUpListener);
            }

            function executeMath() {
                console.log('executeMath');

                applyThumbHeight();

                if (!isScrolling) 
                    applyThumbTop();
            }

            container.on('scroll', executeMath);
            thumb.on('mousedown', onThumbMouseDown);

            executeMath();
        </script>
</html>